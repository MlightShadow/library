# 正则表达式

参考文档:  

* [http://www.regexlab.com/zh/regref.htm](http://www.regexlab.com/zh/regref.htm)
* [https://www.runoob.com/regexp/regexp-tutorial.html](https://www.runoob.com/regexp/regexp-tutorial.html)

## 用途

正则表达式可以用于验证, 查找, 替换字符串.

## 实现

各个语言都包含正则表达式的实现, 其规则都略有增减, 所以使用正则时应注意阅读语言提供的正则方面的文档.

## 符号

所有转义字符请参考转义字符章节

### 普通字符

绝大多数常用字符都是普通字符. 数字, 字母, 汉字, 下划线等正则表达式中没有使用的保留字符都是普通字符

### 转义字符

1. 一些特殊的字符, 参考转义字符章节.
2. 当使用匹配作为正则保留字符的字符串时可使用`\`转义这类字符
   > 例如: 匹配 `$`, 其为正则中的尾匹配字符  
   > 所以当匹配字符串 `$123` 中的`$`时, 应当使用`\$`

### 通配字符

`.`, `\d`, `\w` 等通配字符用于匹配固定的若干种类字符, `.` 可匹配除`\n`和`\r`之外的任何单个字符, 转义字符请参考转义字符章节

`[]` 用于自定义匹配多种字符  
例如:

* `[abc123@_%]`
* `[^abc123]`
* `[0-9a-zA-Z]`
* `[\d]`
* `[^\da-z]`

其中有以下几点知识:  

* `^` 表示否定, 注意:`^`还有表示开头的意思, 参考起止章节
* `-` 含有一定顺序规则的字符可以使用该符号表示其中一段若干字符, 注意:只有连字符在字符组内部时,并且出现在两个字符之间时,才能表示字符的范围; 如果出字符组的开头,则只能表示连字符本身.
* 可以包含转义字符在其中, 注意:无法使用`.`和`[]`

### 起止

`^` 匹配字符串的开始, 但不匹配任何字符, 但是它有两个含义

1. 表示以之后的字符为开头: `^abc`
2. 表示否定: `[^abc]`, 请参考通配字符章节

`$` 匹配字符串的结束, 但不匹配任何字符

`\b`, `\B`表示单词的边界与非边界,请参考转义字符

### 限制

`*`, `+`, `?`, `{n}`, `{n,}`, `{n,m}` 可以限制字符的个数

规则如下表所示f

|符号|含义|
|---|---|
|`*`|匹配子表达式任意次, 例如`a*`可以匹配 `a`, `aa` 与 `aaaaaaaaa`, 另外还有`bbb` 即`a`不存在的情况|
|`+`|匹配子表达式一次或多次, 即至少出现一次|
|`?`|匹配子表达式0次或多次, 当该字符紧跟在任何一个其他限制符 `*`,`+`,`?`, `{n}`, `{n,}`, `{n,m}` 后面时, 匹配模式是非贪婪的. 非贪婪模式尽可能少地匹配所搜索的字符串, 而默认的贪婪模式则尽可能多地匹配所搜索的字符串. 例如: 对于字符串`oooo`, `o+`将尽可能多地匹配`o`, 得到结果`['oooo']`, 而`o+?`将尽可能少地匹配`o`, 得到结果 `['o', 'o', 'o', 'o']`|
|`{n}`|n是一个非负整数. 匹配确定的n次. 例如: `o{2}`不能匹配 `Bob` 中的`o`, 但是能匹配`food` 中的两个`o`|
|`{n,}`|n是一个非负整数. 至少匹配n次. 例如,`o{2,}`不能匹配`Bob`中的`o`, 但能匹配`foooood`中的所有`o`|
|`{n,m}`|m和n均为非负整数, 其中n小于等于m. 最少匹配n次且最多匹配m次. 例如: `o{1,3}`将匹配`fooooood`中的前三个o为一组, 后三个o为一组.|

### 贪婪与非贪婪

TODO

### 组与反向引用

`()` 之间的表达式定义为 `组(group)`, 并且将匹配这个表达式的字符保存到一个临时区域(一个正则表达式中最多可以保存9个),它们可以用 `\1` 到 `\9` 的符号来引用

#### $number 与 \number

TODO

### 非获取匹配

`(?:pattern)` 非获取匹配,匹配pattern但不获取匹配结果,不进行存储供以后使用.这在使用或字符`(|)`来组合一个模式的各个部分时很有用.例如`industr(?:y|ies)`就是一个比`industry|industries`更简略的表达式.

`(?=pattern)` 非获取匹配,正向肯定预查,在任何匹配pattern的字符串开始处匹配查找字符串,该匹配不需要获取供以后使用.例如,`Windows(?=95|98|NT|2000)`能匹配`Windows2000`中的`Windows`,但不能匹配`Windows3.1`中的`Windows`.预查不消耗字符,也就是说,在一个匹配发生后,在最后一次匹配之后立即开始下一次匹配的搜索,而不是从包含预查的字符之后开始.

`(?!pattern)` 非获取匹配,正向否定预查,在任何不匹配pattern的字符串开始处匹配查找字符串,该匹配不需要获取供以后使用.例如`Windows(?!95|98|NT|2000)`能匹配`Windows3.1`中的`Windows`,但不能匹配`Windows2000`中的`Windows`.

`(?<=pattern)` 非获取匹配,反向肯定预查,与正向肯定预查类似,只是方向相反.例如,`(?<=95|98|NT|2000)Windows`能匹配`2000Windows`中的`Windows`,但不能匹配`3.1Windows`中的`Windows`. *python的正则表达式没有完全按照正则表达式规范实现,所以一些高级特性建议使用其他语言如java、scala等

`(?<!patte_n)` 非获取匹配,反向否定预查,与正向否定预查类似,只是方向相反.例如`(?<!95|98|NT|2000)Windows`能匹配`3.1Windows`中的`Windows`,但不能匹配`2000Windows`中的`Windows`. *python的正则表达式没有完全按照正则表达式规范实现,所以一些高级特性建议使用其他语言如java、scala等

### 或

`|` 将两个匹配条件进行逻辑`或`(or)运算.例如正则表达式(him|her) 匹配"it belongs to him"和"it belongs to her",但是不能匹配"it belongs to them.".注意：这个元字符不是所有的软件都支持的.

## 表达式属性

`Ignorecase`

默认情况下，表达式中的字母是要区分大小写的。配置为 Ignorecase 可使匹配时不区分大小写。有的表达式引擎，把 "大小写" 概念延伸至 UNICODE 范围的大小写。

`Singleline`

默认情况下，小数点 "." 匹配除了换行符（\n）以外的字符。配置为 Singleline 可使小数点可匹配包括换行符在内的所有字符。

`Multiline`

默认情况下，表达式 "^" 和 "$" 只匹配字符串的开始 ① 和结尾 ④ 位置。如：

①xxxxxxxxx②\n
③xxxxxxxxx④

配置为 Multiline 可以使 "^" 匹配 ① 外，还可以匹配换行符之后，下一行开始前 ③ 的位置，使 "$" 匹配 ④ 外，还可以匹配换行符之前，一行结束 ② 的位置。

`Global`

主要在将表达式用来替换时起作用，配置为 Global 表示替换所有的匹配。

## `\` 转义

|符号|含义|
|---|---|
|`\b`|匹配单词边界, 用空格隔开的单词的开头结尾|
|`\B`|匹配非单词边界|
|`\cx`||
|`\d`|匹配数字, 等价`[0-9]`|
|`\D`|匹配非数字字符, 等价`[^0-9]`|
|`\f`|匹配换页符, 等价`\x0c`和`\cL`|
|`\n`|匹配换行符, 等价`\x0a`和`\cJ`|
|`\r`|匹配一个回车符, 等价于`\x0d`和`\cM`|
|`\s`|匹配任何不可见字符, 等价`[ \f\n\r\t\v]`|
|`\S`|匹配任何可见字符, 等价`[^ \f\n\r\t\v]`|
|`\t`|匹配制表符, 等价`\x09`和`\cI`|
|`\v`|匹配垂直制表符.等价`\x0b`和`\cK`|
|`\w`|匹配包括下划线的任何Unicode字符集单词字符|
|`\W`|匹配任何非单词字符, 等价`[^A-Za-z0-9_]`|
|`\xn`|匹配n,其中n为十六进制转义值.十六进制转义值必须为确定的两个数字长.例如,`\x41`匹配`A`.`\x041`则等价于`\x04&1`.正则表达式中可以使用ASCII编码|
|`\num`|匹配num,其中num是一个正整数.对所获取的匹配的引用.例如,`(.)\1`匹配两个连续的相同字符|
|`\n`|标识一个八进制转义值或一个向后引用.如果\n之前至少n个获取的子表达式,则n为向后引用.否则,如果n为八进制数字(0-7),则n为一个八进制转义值|
|`\nm`|标识一个八进制转义值或一个向后引用.如果\nm之前至少有nm个获得子表达式,则nm为向后引用.如果\nm之前至少有n个获取,则n为一个后跟文字m的向后引用.如果前面的条件都不满足,若n和m均为八进制数字(0-7),则\nm将匹配八进制转义值nm|
|`\nml`|如果n为八进制数字(0-7),且m和l均为八进制数字(0-7),则匹配八进制转义值nml|
|`\un`|匹配n,其中n是一个用四个十六进制数字表示的Unicode字符.例如,\u00A9匹配版权符号(&copy;)|
|`\p{P}`|小写 p 是 property 的意思,表示 Unicode 属性,用于 Unicode 正表达式的前缀.中括号内的`P`表示Unicode 字符集七个字符属性之一：标点字符.其他六个属性：L：字母；M：标记符号(一般不会单独出现)；Z：分隔符(比如空格、换行等)；S：符号(比如数学符号、货币符号等)；N：数字(比如阿拉伯数字、罗马数字等)；C：其他字符.*注：此语法部分语言不支持,例：javascript.|
|`\<` `\>`|匹配词(word)的开始(\<)和结束(\>).例如正则表达式\<the\>能够匹配字符串"for the wise"中的"the",但是不能匹配字符串"otherwise"中的"the".注意：这个元字符不是所有的软件都支持的.|
